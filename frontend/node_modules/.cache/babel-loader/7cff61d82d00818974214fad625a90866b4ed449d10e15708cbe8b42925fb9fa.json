{"ast":null,"code":"// =====================\n// dashboard.js\n// =====================\n\nconst API_BASE = \"http://localhost:3001/api\"; // adjust if your backend uses a different port\n\n// --- Load all alerts and refresh UI\nasync function loadAlerts() {\n  try {\n    const res = await fetch(`${API_BASE}/alerts`);\n    const data = await res.json();\n    renderTable(data);\n    renderSummary(data);\n    renderChart(data);\n  } catch (err) {\n    console.error(\"Error loading alerts:\", err);\n  }\n}\n\n// --- Update dashboard cards\nfunction renderSummary(data) {\n  document.getElementById(\"totalAlerts\").innerText = data.length;\n  document.getElementById(\"approvedCount\").innerText = data.filter(a => a.decision === \"approve\").length;\n  document.getElementById(\"blockedCount\").innerText = data.filter(a => a.decision === \"block\").length;\n  document.getElementById(\"pendingCount\").innerText = data.filter(a => !a.decision || a.decision === \"pending\").length;\n}\n\n// --- Build transaction table\nfunction renderTable(data) {\n  const body = document.getElementById(\"alertsBody\");\n  body.innerHTML = \"\";\n  data.forEach(a => {\n    var _a$amount;\n    const risk = a.score >= 0.7 ? \"high\" : a.score >= 0.4 ? \"medium\" : \"low\";\n    const tr = document.createElement(\"tr\");\n    tr.innerHTML = `\n      <td>${a.account_id || \"—\"}</td>\n      <td>$${((_a$amount = a.amount) === null || _a$amount === void 0 ? void 0 : _a$amount.toFixed(2)) || \"0.00\"}</td>\n      <td><span class=\"badge ${risk}\">${(a.score * 100).toFixed(0)}%</span></td>\n      <td>${a.decision || \"Pending\"}</td>\n      <td>${a.reason || \"N/A\"}</td>\n      <td class=\"action-icons\">\n        <button class=\"ok\" onclick=\"updateAction('${a._id}','approve')\"><i class=\"fa fa-check\"></i></button>\n        <button class=\"remove\" onclick=\"updateAction('${a._id}','block')\"><i class=\"fa fa-times-circle\"></i></button>\n      </td>`;\n    body.appendChild(tr);\n  });\n}\n\n// --- Approve or block button actions\nasync function updateAction(id, action) {\n  try {\n    const res = await fetch(`${API_BASE}/action`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        alertId: id,\n        action\n      })\n    });\n    if (!res.ok) throw new Error(\"Action failed\");\n    loadAlerts(); // reload table after updating\n  } catch (err) {\n    console.error(\"Error updating action:\", err);\n    alert(\"Failed to update action. Please check backend logs.\");\n  }\n}\n\n// --- Risk score distribution chart\nfunction renderChart(data) {\n  const bins = Array(10).fill(0);\n  data.forEach(a => {\n    const idx = Math.min(9, Math.floor(a.score * 10));\n    bins[idx]++;\n  });\n  const ctx = document.getElementById(\"riskChart\").getContext(\"2d\");\n  if (window.chartInstance) window.chartInstance.destroy();\n  window.chartInstance = new Chart(ctx, {\n    type: \"bar\",\n    data: {\n      labels: [\"0–10\", \"10–20\", \"20–30\", \"30–40\", \"40–50\", \"50–60\", \"60–70\", \"70–80\", \"80–90\", \"90–100\"],\n      datasets: [{\n        label: \"Transactions\",\n        data: bins,\n        backgroundColor: \"rgba(124,58,237,0.9)\",\n        borderRadius: 6\n      }]\n    },\n    options: {\n      plugins: {\n        legend: {\n          display: false\n        }\n      },\n      scales: {\n        x: {\n          grid: {\n            display: false\n          }\n        },\n        y: {\n          grid: {\n            color: \"rgba(255,255,255,0.05)\"\n          }\n        }\n      }\n    }\n  });\n}\n\n// --- Export CSV\ndocument.getElementById(\"btnExport\").addEventListener(\"click\", async () => {\n  try {\n    const res = await fetch(`${API_BASE}/alerts`);\n    const data = await res.json();\n    const rows = [[\"account_id\", \"amount\", \"score\", \"decision\", \"reason\"]];\n    data.forEach(a => rows.push([a.account_id, a.amount, a.score, a.decision, a.reason]));\n    const csv = rows.map(r => r.join(\",\")).join(\"\\n\");\n    const blob = new Blob([csv], {\n      type: \"text/csv\"\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = \"fraud_alerts.csv\";\n    a.click();\n    URL.revokeObjectURL(url);\n  } catch (err) {\n    console.error(\"Export error:\", err);\n  }\n});\n\n// --- Auto-refresh every 10 seconds\nsetInterval(loadAlerts, 10000);\n\n// --- Initial load\nloadAlerts();","map":{"version":3,"names":["API_BASE","loadAlerts","res","fetch","data","json","renderTable","renderSummary","renderChart","err","console","error","document","getElementById","innerText","length","filter","a","decision","body","innerHTML","forEach","_a$amount","risk","score","tr","createElement","account_id","amount","toFixed","reason","_id","appendChild","updateAction","id","action","method","headers","JSON","stringify","alertId","ok","Error","alert","bins","Array","fill","idx","Math","min","floor","ctx","getContext","window","chartInstance","destroy","Chart","type","labels","datasets","label","backgroundColor","borderRadius","options","plugins","legend","display","scales","x","grid","y","color","addEventListener","rows","push","csv","map","r","join","blob","Blob","url","URL","createObjectURL","href","download","click","revokeObjectURL","setInterval"],"sources":["C:/Users/Varun/OneDrive/Desktop/fraud-pipeline/frontend/src/App.js"],"sourcesContent":["// =====================\r\n// dashboard.js\r\n// =====================\r\n\r\nconst API_BASE = \"http://localhost:3001/api\"; // adjust if your backend uses a different port\r\n\r\n// --- Load all alerts and refresh UI\r\nasync function loadAlerts() {\r\n  try {\r\n    const res = await fetch(`${API_BASE}/alerts`);\r\n    const data = await res.json();\r\n\r\n    renderTable(data);\r\n    renderSummary(data);\r\n    renderChart(data);\r\n  } catch (err) {\r\n    console.error(\"Error loading alerts:\", err);\r\n  }\r\n}\r\n\r\n// --- Update dashboard cards\r\nfunction renderSummary(data) {\r\n  document.getElementById(\"totalAlerts\").innerText = data.length;\r\n  document.getElementById(\"approvedCount\").innerText = data.filter(a => a.decision === \"approve\").length;\r\n  document.getElementById(\"blockedCount\").innerText = data.filter(a => a.decision === \"block\").length;\r\n  document.getElementById(\"pendingCount\").innerText = data.filter(a => !a.decision || a.decision === \"pending\").length;\r\n}\r\n\r\n// --- Build transaction table\r\nfunction renderTable(data) {\r\n  const body = document.getElementById(\"alertsBody\");\r\n  body.innerHTML = \"\";\r\n\r\n  data.forEach(a => {\r\n    const risk = a.score >= 0.7 ? \"high\" : a.score >= 0.4 ? \"medium\" : \"low\";\r\n\r\n    const tr = document.createElement(\"tr\");\r\n    tr.innerHTML = `\r\n      <td>${a.account_id || \"—\"}</td>\r\n      <td>$${a.amount?.toFixed(2) || \"0.00\"}</td>\r\n      <td><span class=\"badge ${risk}\">${(a.score * 100).toFixed(0)}%</span></td>\r\n      <td>${a.decision || \"Pending\"}</td>\r\n      <td>${a.reason || \"N/A\"}</td>\r\n      <td class=\"action-icons\">\r\n        <button class=\"ok\" onclick=\"updateAction('${a._id}','approve')\"><i class=\"fa fa-check\"></i></button>\r\n        <button class=\"remove\" onclick=\"updateAction('${a._id}','block')\"><i class=\"fa fa-times-circle\"></i></button>\r\n      </td>`;\r\n    body.appendChild(tr);\r\n  });\r\n}\r\n\r\n// --- Approve or block button actions\r\nasync function updateAction(id, action) {\r\n  try {\r\n    const res = await fetch(`${API_BASE}/action`, {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ alertId: id, action }),\r\n    });\r\n\r\n    if (!res.ok) throw new Error(\"Action failed\");\r\n\r\n    loadAlerts(); // reload table after updating\r\n  } catch (err) {\r\n    console.error(\"Error updating action:\", err);\r\n    alert(\"Failed to update action. Please check backend logs.\");\r\n  }\r\n}\r\n\r\n// --- Risk score distribution chart\r\nfunction renderChart(data) {\r\n  const bins = Array(10).fill(0);\r\n  data.forEach(a => {\r\n    const idx = Math.min(9, Math.floor(a.score * 10));\r\n    bins[idx]++;\r\n  });\r\n\r\n  const ctx = document.getElementById(\"riskChart\").getContext(\"2d\");\r\n\r\n  if (window.chartInstance) window.chartInstance.destroy();\r\n\r\n  window.chartInstance = new Chart(ctx, {\r\n    type: \"bar\",\r\n    data: {\r\n      labels: [\"0–10\", \"10–20\", \"20–30\", \"30–40\", \"40–50\", \"50–60\", \"60–70\", \"70–80\", \"80–90\", \"90–100\"],\r\n      datasets: [{\r\n        label: \"Transactions\",\r\n        data: bins,\r\n        backgroundColor: \"rgba(124,58,237,0.9)\",\r\n        borderRadius: 6\r\n      }]\r\n    },\r\n    options: {\r\n      plugins: { legend: { display: false } },\r\n      scales: {\r\n        x: { grid: { display: false } },\r\n        y: { grid: { color: \"rgba(255,255,255,0.05)\" } }\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n// --- Export CSV\r\ndocument.getElementById(\"btnExport\").addEventListener(\"click\", async () => {\r\n  try {\r\n    const res = await fetch(`${API_BASE}/alerts`);\r\n    const data = await res.json();\r\n    const rows = [[\"account_id\", \"amount\", \"score\", \"decision\", \"reason\"]];\r\n    data.forEach(a => rows.push([a.account_id, a.amount, a.score, a.decision, a.reason]));\r\n    const csv = rows.map(r => r.join(\",\")).join(\"\\n\");\r\n    const blob = new Blob([csv], { type: \"text/csv\" });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement(\"a\");\r\n    a.href = url; a.download = \"fraud_alerts.csv\"; a.click();\r\n    URL.revokeObjectURL(url);\r\n  } catch (err) {\r\n    console.error(\"Export error:\", err);\r\n  }\r\n});\r\n\r\n// --- Auto-refresh every 10 seconds\r\nsetInterval(loadAlerts, 10000);\r\n\r\n// --- Initial load\r\nloadAlerts();\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}